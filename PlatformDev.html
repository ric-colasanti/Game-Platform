<!DOCTYPE html>
<html lang="en">
<!--
   Platform.html
   
   Copyright 2020 Unknown <ric@localhost>
   
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 2 of the License, or
   (at your option) any later version.
   
   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
   
   You should have received a copy of the GNU General Public License
   along with this program; if not, write to the Free Software
   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
   MA 02110-1301, USA.
   
   
-->

<head>
<meta charset="utf-8" />
<title>Platform</title>
<meta name="generator" content="Geany 1.36" />
<style>
    body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        div {
            max-width: 640px;
            margin: 0 auto;
            text-align: center;
        }

        #bg {
            display: block;
            margin: 0 auto 16px;
        }
</style>
</head>
<body>
    <div>
        <canvas id="bg" width="340" height="700"></canvas>
        <button id="btnStart" class="btn btn-default">Start/stop animation</button>
    </div>
 <script src="js/background.js"></script> 
 <script src="js/resources.js"></script> 
<script>
    (function() {
        window.requestAnimationFrame = window.requestAnimationFrame
                || window.webkitRequestAnimationFrame
                || window.mozRequestAnimationFrame
                || function(callback) { window.setTimeout(callback, 1000 / 60); };

        var canvas = document.getElementById('bg');
        var context = canvas.getContext('2d');
        var looping = false;
        var totalSeconds = 0;
        var bg1 = null;
        var bg2 = null;
        
        var resources = new Resources(['img/BG1.png','img/BG2.png'],imageLoaded)
        function imageLoaded(){
            var img1 = resources.imageObjects["BG1"]
            var img2 = resources.imageObjects["BG2"]
            bg1 = new Background(canvas,context,img1,0,10)
            bg2 = new Background(canvas,context,img2,img1.height - img2.height,40)
            bg1.draw(0)
            bg2.draw(0)

            var btn = document.getElementById('btnStart');
            btn.addEventListener('click', function() {
                startStop();
            });
        }


        var lastFrameTime = 0;

        function startStop() {
            looping = !looping;
            if (looping) {
                lastFrameTime = Date.now();
                requestAnimationFrame(loop);
            }
        }

        function loop() {
            if (!looping) {
                return;
            }

            requestAnimationFrame(loop);

            var now = Date.now();
            var deltaSeconds = (now - lastFrameTime) / 1000;
            lastFrameTime = now;
            bg1.draw(deltaSeconds);
            bg2.draw(deltaSeconds);
        }
    }());
    </script>

</body>

</html>
